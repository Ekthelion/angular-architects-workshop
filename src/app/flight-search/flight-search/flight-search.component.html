<div class="container">
  <div class="mb-3 form-group">
    <label for="from" class="form-label">From</label>
    <input
      type="text"
      class="form-control"
      placeholder="From"
      name="from"
      [(ngModel)]="from"
    />
  </div>
  <div class="mb-3 form-group">
    <label for="to" class="form-label">To</label>
    <input
      type="text"
      class="form-control"
      placeholder="To"
      name="to"
      [ngModel]="to"
      (ngModelChange)="to = $event"
    />
  </div>

  <div
    class="btn-toolbar justify-content-between"
    role="toolbar"
    aria-label="Toolbar with button groups"
  >
    <button
      class="btn btn-default"
      [disabled]="!from || !to"
      (click)="search()"
    >
      Search
    </button>
    <button class="btn btn-primary" (click)="addFlight()">Add</button>
  </div>
</div>
<table class="table table-condensed">
  <thead>
    <tr>
      <th>Id</th>
      <th>From</th>
      <th>To</th>
      <th>Date</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr *ngIf="flights.length === 0">
      <td colspan="5">No flights found</td>
    </tr>
    <tr
      *ngFor="let flight of flights | statusFilter : false"
      [ngClass]="{
        'table-active': selectedFlight?.id === flight.id,
        'table-danger': flight.delayed,
      }"
    >
      <td>{{ flight.id }}</td>
      <td>{{ flight.from | city : "long" | titlecase }}</td>
      <td>{{ flight.to | asyncCity : "short" | async | uppercase }}</td>
      <td [ngClass]="flight | statusColor">{{ flight.date | date }}</td>
      <td>
        <a role="button" class="link-primary" (click)="selectFlight(flight)"
          >Select</a
        >
      </td>
    </tr>
  </tbody>
</table>
<div class="card" *ngIf="selectedFlight">
  <div class="card-body">
    <div class="alert alert-success" *ngIf="messageSuccess">
      {{ messageSuccess }}
    </div>
    <div class="alert alert-danger" *ngIf="messageError">
      {{ messageError }}
    </div>

    <div class="form-group" *ngIf="selectedFlight.id !== 0">
      <label>Id</label>
      <input
        class="form-control"
        name="from"
        readonly
        [disabled]="true"
        [(ngModel)]="selectedFlight.id"
      />
    </div>

    <div class="form-group">
      <label>From</label>
      <input class="form-control" [(ngModel)]="selectedFlight.from" />
    </div>

    <div class="form-group">
      <label>To</label>
      <input class="form-control" [(ngModel)]="selectedFlight.to" />
    </div>

    <div class="form-group">
      <label>Date</label>
      <input class="form-control" [(ngModel)]="selectedFlight.date" />
    </div>

    <div class="form-group">
      <input
        type="checkbox"
        id="delayed"
        [(ngModel)]="selectedFlight.delayed"
      />
      <label class="form-check-label" for="delayed"> delayed</label>
    </div>

    <div
      class="btn-toolbar justify-content-between"
      role="toolbar"
      aria-label="Toolbar with button groups"
    >
      <button
        class="btn btn-primary"
        (click)="save()"
        [disabled]="
          !selectedFlight.from || !selectedFlight.to || !selectedFlight.date
        "
      >
        Save
      </button>
      <button class="btn btn-secondary" (click)="cancel()">Cancel</button>
    </div>
  </div>
</div>
